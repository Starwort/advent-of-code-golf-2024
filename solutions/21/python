from functools import*
L=*open(0),
@cache
def F(s,k,r):(B,_),*w=[divmod((k*"_^A<v>"+"789456123_0A").find(c),3)for c in"_A"+s];return k>r or sum(F(("<"*(x-X)+"v^"[Y<y]*abs(y-Y)+">"*(X-x))[::0!=(x|Y-B)*(X|y-B)or-1]+"A",k+1,r)for(y,x),(Y,X)in zip(w,w[1:]))
for n in 3,26:print(sum(int(l[:3])*F(l.strip(),0,n)for l in L))