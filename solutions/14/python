from numpy import*
x,X=c_[[[eval(c[2:])for c in l.split()]for l in open(0)]].T.mT.T
f=[prod(bincount((x:=(x+X)%[*b'eg'])[all(w+~x,1)]//w@[2,1]))for*w,in[b'34']*9999]
print(f[99],argmin(f)+1)