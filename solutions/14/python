P=[eval(x[2:].replace("v=",","))for x in open(0)]
i=0
while len({v[:2]for v in P})-len(P):
 if i==100:o=1;[o:=o*sum(a==x//51+y//52*2for x,y,*_ in P if x+1!=51!=y)for a in range(4)];print(o)
 P=[((x+v)%101,(y+w)%103,v,w)for x,y,v,w in P];i+=1
print(i)