from operator import*
XOR,OR,AND=xor,or_,and_
C={};e='=lambda:';Q=[]
O=lambda c:any(x=='OR'and{c}<{a,b}for a,x,b in C.values())
for l in open(0):
 try:a,x,b,_,c=l.split();C[c]=a,x,b;exec(f"{c}{e}{x}({a}(),{b}())")
 except:exec(l.replace(':',e))
for c in C:
 x,a,b=sorted(C[c])
 if'X'<x:
  if O(c)or'x'>a<b<'y'<'z'>c:Q+=c,
 elif'z'<c<'z45'or 1-O(c)and'B'>x<'x00'<a:Q+=c,
print(sum(eval(f"z{i:02}()<<{i}")for i in range(46)),','.join(sorted(Q)))