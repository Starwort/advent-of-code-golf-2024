from numpy import*
w=repeat(r_[:len(x:=r_[*map(int,input()),0])],x)
v=19998
o=r_[p:=0,cumsum(x)]
for q in x[-2::-2]:x[t:=min((v,1+2*argmin(q>x[1::2])))]-=q;p+=(q-1+o[t]*2)*q*v//4;o[t]+=q;v-=2
print(sum(minimum(X:=where(~w%2)[0],r_[where(w%2)[0],X|p][argsort(-X)])*w[X]//2),p)