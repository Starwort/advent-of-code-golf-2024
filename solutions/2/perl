sub S{$z=$e=0;"@F"=~s@\S+ @$d=$'-$&;$z|=$&?$d!~/^-?[123]$/|$d*$e<0:0;$e=$d@ger;!$z}map{$p=@F=glob;$A+=S;@F=glob while$p--&&(splice@F,$p,1)&&!S;$\+=S}<>;print"$A "