h:#G:(*<x)#x:0:0
s:+/100/&:
s"O"=G(M:{(Y;X):,/&64=x;.[x;I;:;v@>>':|\(46=v)&~|\35=v:x. I:((|1+!Y;X);(Y_!h;X);(Y;|1+!X);(Y;X_!#*G))"^v<>"?y]})/V:,/(*<x)_x
G:"."^,/'("##";"[]";"@.")"#O@"?G
{$["v"=x;[G::|G;o["^"];G::|G];94=x;{$[*k:|y{?,/x+(0 1;0 -1;!0;0;0)"[].@ "?y@x}\|(1+x)#G;;0 0{.[`G;y;:;"."];G[*y;*|x]:G. x}':(!2+*x),','k,,!0]}.&64=G;G::M[G]x]}'V;s"["=G