any(print(sum(next(reversed(list(len(((list)if(l)else(set))(j))for(c)in(range(len(set(str(map)))))for(j)in(list(next(iter(e))for(e)in(enumerate(h))if(str(c)in(e))for(m)in(j)if(frozenset((m)if(o)else(next(iter(e)))for(o)in(g))in(k)))if(c)else(list(next(iter(i))for(d)in(d)))for(d)in(d)))))for(i)in(enumerate(h))if(d)in(i)))for(d)in(str(int()))for(g)in(range(len(str(())))for(d)in(d))for(a)in(list(open(int()))for(d)in(d))for(h)in(list((n)for(b)in(a)for(n)in(b))for(d)in(d))for(k)in(set(frozenset((m)if(p)else(sum((m)if(f)else(o)or(len(max(a)))for(f)in(g)))for(p)in(g))for(m)in(range(len(h)))for(o)in(g))for(d)in(d))for(l)in(g))