s={gets[-1]=>-q=-1}
f=->d{s[d]||=$_.scan(/\w+/).sum{d=~/^#{_1}/?f[$']:0}}
p$<.count{q<q+=f[_1]}-1,q